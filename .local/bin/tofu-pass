#!/bin/sh
set -eu

export BEMENU_OPTS='-i -l 10 -B 5 -H 40 -W 0.33 --fn "monospace 14" -p ">" --hp 5 -c --fixed-height'

selection=$(find "$PASSWORD_STORE_DIR" -name "*.gpg" -printf "%P\n" | sed "s/.gpg$//" | bemenu)
if [ $? -neq 0 ]; then
    exit 1
fi

password=$(pass show "$selection" | head -n1 | tr -d '\n')
if [ "$password" = "" ]; then
    exit 1
fi

slurp -p
ydotool click 0xC0
sleep 0.1
printf '%s' "$password" | ydotool type -f -

